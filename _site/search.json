[
  {
    "objectID": "in-class_exercises/in-class_ex03/in-class_Ex03.html",
    "href": "in-class_exercises/in-class_ex03/in-class_Ex03.html",
    "title": "In-class_exercise 3",
    "section": "",
    "text": "Load packages\n\n  pacman::p_load(sf, raster, spatstat, tmap, tidyverse)\n\n\n\nImport data and transform\n\nacled_sf &lt;- read_csv(\"data/Myanmar/ACLED_Myanmar.csv\") %&gt;%\n  st_as_sf(coords = c(\n    \"longitude\", \"latitude\"),\n    crs=4326) %&gt;% #wgs84 crs is 4326\n  st_transform(crs = 32647) %&gt;% #for myanmar wgs84 crs is 32647\n  mutate(event_date = dmy(event_date))\n\nRows: 55574 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nMapping and Plotting\n\n  tmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n  acled_sf %&gt;%\n    filter(year == 2023 | \n             event_type == \"Political violence\") %&gt;%\n    tm_shape()+\n    tm_dots()"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "",
    "text": "are the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nif the answer is NO, where and when the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "in-class_exercises/in-class_ex01/data/MPSZ-2019/MPSZ-2019.html",
    "href": "in-class_exercises/in-class_ex01/data/MPSZ-2019/MPSZ-2019.html",
    "title": "IS415-GAA",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "in-class_exercises/in-class_ex02/data/geospatial/MPSZ-2019/MPSZ-2019.html",
    "href": "in-class_exercises/in-class_ex02/data/geospatial/MPSZ-2019/MPSZ-2019.html",
    "title": "IS415-GAA",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IS415-GAA",
    "section": "",
    "text": "Welcome to my IS415 Geospatial Analytics and Applications website. In this site, you will be able to view weekly learning, projects, and notes. Stay tuned :)\nBelow are some important/useful codes and concepts that can be implemented."
  },
  {
    "objectID": "index.html#importantuseful-codes",
    "href": "index.html#importantuseful-codes",
    "title": "IS415-GAA",
    "section": "Important/Useful Codes",
    "text": "Important/Useful Codes\n\nprint new line (useful for separating codes)\n\ncat(\"\\n\")\n\n\ne.g\n\n\n    cat(\"5555\")\n\n5555\n\n    cat(\"\\n\")\n    cat(\"6666\")\n\n6666\n\n\nlist all packages with { package-name : version number }\n\ncan view packages have been installed and its latest version\n\n\n    ip = as.data.frame(installed.packages()[,c(1,3:4)])\n    ip = ip[is.na(ip$Priority),1:2,drop=FALSE]\n    ip\n\n                            Package   Version\nabind                         abind     1.4-5\naskpass                     askpass     1.2.0\nbackports                 backports     1.5.0\nbase64enc                 base64enc     0.1-3\nbit                             bit     4.0.5\nbit64                         bit64     4.0.5\nblob                           blob     1.2.4\nbrew                           brew    1.0-10\nbrio                           brio     1.1.5\nbroom                         broom     1.0.6\nbslib                         bslib     0.8.0\ncachem                       cachem     1.1.0\ncallr                         callr     3.7.6\ncellranger               cellranger     1.1.0\nclassInt                   classInt    0.4-10\ncli                             cli     3.6.3\nclipr                         clipr     0.8.0\ncolorspace               colorspace     2.1-1\ncommonmark               commonmark     1.9.1\nconflicted               conflicted     1.2.0\ncovr                           covr     3.6.4\ncpp11                         cpp11     0.4.7\ncrayon                       crayon     1.5.3\ncredentials             credentials     2.0.1\ncrosstalk                 crosstalk     1.2.1\ncurl                           curl     5.2.1\ndata.table               data.table    1.15.4\nDBI                             DBI     1.2.3\ndbplyr                       dbplyr     2.5.0\ndeldir                       deldir     2.0-4\ndesc                           desc     1.4.3\ndevtools                   devtools     2.4.5\ndichromat                 dichromat   2.0-0.1\ndiffobj                     diffobj     0.3.5\ndigest                       digest    0.6.36\ndoParallel               doParallel    1.0.17\ndownlit                     downlit     0.4.4\ndplyr                         dplyr     1.1.4\ndtplyr                       dtplyr     1.3.1\ne1071                         e1071    1.7-14\nellipsis                   ellipsis     0.3.2\nevaluate                   evaluate    0.24.0\nfansi                         fansi     1.0.6\nfarver                       farver     2.1.2\nfastmap                     fastmap     1.2.0\nfontawesome             fontawesome     0.5.2\nforcats                     forcats     1.0.0\nforeach                     foreach     1.5.2\nfs                               fs     1.6.4\ngargle                       gargle     1.5.2\ngenerics                   generics     0.1.3\ngeojsonsf                 geojsonsf     2.0.3\ngeometries               geometries     0.2.4\ngert                           gert     2.1.1\nggplot2                     ggplot2     3.5.1\ngh                               gh     1.4.1\ngitcreds                   gitcreds     0.1.2\nglue                           glue     1.7.0\ngoftest                     goftest     1.2-3\ngoogledrive             googledrive     2.1.1\ngooglesheets4         googlesheets4     1.1.1\ngtable                       gtable     0.3.5\nhaven                         haven     2.5.4\nhighr                         highr      0.11\nhms                             hms     1.1.3\nhtmltools                 htmltools   0.5.8.1\nhtmlwidgets             htmlwidgets     1.6.4\nhttpuv                       httpuv    1.6.15\nhttr                           httr     1.4.7\nhttr2                         httr2     1.0.2\nids                             ids     1.0.1\nini                             ini     0.3.1\nisoband                     isoband     0.2.7\niterators                 iterators    1.0.14\njquerylib                 jquerylib     0.1.4\njsonify                     jsonify     1.2.2\njsonlite                   jsonlite     1.8.8\nknitr                         knitr      1.48\nlabeling                   labeling     0.4.3\nlater                         later     1.3.2\nlazyeval                   lazyeval     0.2.2\nleafem                       leafem     0.2.3\nleaflet                     leaflet     2.2.2\nleaflet.providers leaflet.providers     2.0.0\nleafpop                     leafpop     0.1.0\nleafsync                   leafsync     0.1.0\nlifecycle                 lifecycle     1.0.4\nlubridate                 lubridate     1.9.3\nlwgeom                       lwgeom    0.2-14\nmagrittr                   magrittr     2.0.3\nmaps                           maps     3.4.2\nmaptools                   maptools     1.1-8\nmapview                     mapview    2.11.2\nmemoise                     memoise     2.0.1\nmicrobenchmark       microbenchmark    1.4.10\nmime                           mime      0.12\nminiUI                       miniUI   0.1.1.1\nmisc3d                       misc3d     0.9-1\nmodelr                       modelr    0.1.11\nmunsell                     munsell     0.5.1\nnanoarrow                 nanoarrow   0.5.0.1\nodbc                           odbc     1.5.0\nopenssl                     openssl     2.2.1\npacman                       pacman     0.5.1\npbapply                     pbapply     1.7-2\npillar                       pillar     1.9.0\npkgbuild                   pkgbuild     1.4.4\npkgconfig                 pkgconfig     2.0.3\npkgdown                     pkgdown     2.1.0\npkgload                     pkgload     1.4.0\nplogr                         plogr     0.2.0\nplyr                           plyr     1.8.9\npng                             png     0.1-8\npolyclip                   polyclip    1.10-7\npool                           pool     1.0.3\npraise                       praise     1.0.0\nprettyunits             prettyunits     1.2.0\nprocessx                   processx     3.8.4\nprofvis                     profvis     0.3.8\nprogress                   progress     1.2.3\npromises                   promises     1.3.0\nproxy                         proxy    0.4-27\nps                               ps     1.7.7\npurrr                         purrr     1.0.2\nquarto                       quarto     1.4.4\nR6                               R6     2.5.1\nragg                           ragg     1.3.2\nrapidjsonr               rapidjsonr     1.2.0\nrappdirs                   rappdirs     0.3.3\nraster                       raster    3.6-26\nrcmdcheck                 rcmdcheck     1.4.0\nRColorBrewer           RColorBrewer     1.1-3\nRcpp                           Rcpp    1.0.13\nreadr                         readr     2.1.5\nreadxl                       readxl     1.4.3\nrematch                     rematch     2.0.0\nrematch2                   rematch2     2.1.2\nremotes                     remotes     2.5.0\nreprex                       reprex     2.1.1\nrex                             rex     1.2.1\nrlang                         rlang     1.1.4\nrmarkdown                 rmarkdown      2.27\nroxygen2                   roxygen2     7.3.2\nRPostgres                 RPostgres     1.4.7\nRPostgreSQL             RPostgreSQL     0.7-6\nrprojroot                 rprojroot     2.0.4\nRSQLite                     RSQLite     2.3.7\nrstudioapi               rstudioapi    0.16.0\nrversions                 rversions     2.1.2\nrvest                         rvest     1.0.4\ns2                               s2     1.1.7\nsass                           sass     0.4.9\nsatellite                 satellite     1.0.5\nscales                       scales     1.3.0\nselectr                     selectr     0.4-2\nservr                         servr      0.30\nsessioninfo             sessioninfo     1.2.2\nsf                               sf    1.0-16\nsfheaders                 sfheaders     0.4.4\nshiny                         shiny     1.9.1\nsourcetools             sourcetools   0.1.7-1\nsp                               sp     2.1-4\nsparr                         sparr    2.3-15\nspatstat                   spatstat     3.1-1\nspatstat.data         spatstat.data     3.1-2\nspatstat.explore   spatstat.explore     3.3-2\nspatstat.geom         spatstat.geom     3.3-2\nspatstat.linnet     spatstat.linnet     3.2-1\nspatstat.model       spatstat.model     3.3-1\nspatstat.random     spatstat.random     3.3-1\nspatstat.sparse     spatstat.sparse     3.1-0\nspatstat.univar     spatstat.univar     3.0-0\nspatstat.utils       spatstat.utils     3.1-0\nspData                       spData     2.3.3\nspdep                         spdep     1.3-6\nstars                         stars     0.6-6\nstringi                     stringi     1.8.4\nstringr                     stringr     1.5.1\nsvglite                     svglite     2.1.3\nsys                             sys     3.4.2\nsystemfonts             systemfonts     1.1.0\ntensor                       tensor       1.5\nterra                         terra    1.7-78\ntestthat                   testthat   3.2.1.1\ntextshaping             textshaping     0.4.0\ntibble                       tibble     3.2.1\ntidyr                         tidyr     1.3.1\ntidyselect               tidyselect     1.2.1\ntidyverse                 tidyverse     2.0.0\ntimechange               timechange     0.3.0\ntinytex                     tinytex      0.52\ntmap                           tmap     3.3-4\ntmaptools                 tmaptools     3.1-1\ntranslations           translations     4.4.1\ntzdb                           tzdb     0.4.0\nunits                         units     0.8-5\nurlchecker               urlchecker     1.0.1\nusethis                     usethis     3.0.0\nutf8                           utf8     1.2.4\nuuid                           uuid     1.2-1\nvctrs                         vctrs     0.6.5\nviridisLite             viridisLite     0.4.2\nvroom                         vroom     1.6.5\nwaldo                         waldo     0.5.2\nwhisker                     whisker     0.4.1\nwidgetframe             widgetframe     0.3.1\nwithr                         withr     3.0.1\nwk                               wk     0.9.2\nxfun                           xfun      0.46\nXML                             XML 3.99-0.17\nxml2                           xml2     1.3.6\nxopen                         xopen     1.0.1\nxtable                       xtable     1.8-4\nyaml                           yaml    2.3.10\nzip                             zip     2.3.1"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html",
    "title": "Take-home Exercise 1",
    "section": "",
    "text": "testing"
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "IS415-GAA",
    "section": "1.0 Introduction",
    "text": "1.0 Introduction"
  },
  {
    "objectID": "index.html#importing-packages",
    "href": "index.html#importing-packages",
    "title": "IS415-GAA",
    "section": "2.0 Importing Packages",
    "text": "2.0 Importing Packages"
  },
  {
    "objectID": "index.html#importing-datasets-into-environment",
    "href": "index.html#importing-datasets-into-environment",
    "title": "IS415-GAA",
    "section": "3.0 Importing Datasets into Environment",
    "text": "3.0 Importing Datasets into Environment"
  },
  {
    "objectID": "index.html#projection-transformation",
    "href": "index.html#projection-transformation",
    "title": "IS415-GAA",
    "section": "4.0 Projection Transformation",
    "text": "4.0 Projection Transformation"
  },
  {
    "objectID": "index.html#data-wrangling",
    "href": "index.html#data-wrangling",
    "title": "IS415-GAA",
    "section": "5.0 Data Wrangling",
    "text": "5.0 Data Wrangling"
  },
  {
    "objectID": "index.html#exploratory-spatial-data-analysis",
    "href": "index.html#exploratory-spatial-data-analysis",
    "title": "IS415-GAA",
    "section": "6.0 Exploratory Spatial Data Analysis",
    "text": "6.0 Exploratory Spatial Data Analysis"
  },
  {
    "objectID": "index.html#measuring-dispersion",
    "href": "index.html#measuring-dispersion",
    "title": "IS415-GAA",
    "section": "7.0 Measuring Dispersion??",
    "text": "7.0 Measuring Dispersion??"
  },
  {
    "objectID": "index.html#first-ordersecond-order-sppa",
    "href": "index.html#first-ordersecond-order-sppa",
    "title": "IS415-GAA",
    "section": "8.0 First Order/Second Order SPPA",
    "text": "8.0 First Order/Second Order SPPA"
  },
  {
    "objectID": "index.html#kernel-density-estimation",
    "href": "index.html#kernel-density-estimation",
    "title": "IS415-GAA",
    "section": "9.0 Kernel Density Estimation",
    "text": "9.0 Kernel Density Estimation"
  },
  {
    "objectID": "index.html#conclusion",
    "href": "index.html#conclusion",
    "title": "IS415-GAA",
    "section": "10.0 Conclusion",
    "text": "10.0 Conclusion"
  },
  {
    "objectID": "index.html#references",
    "href": "index.html#references",
    "title": "IS415-GAA",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#introduction",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#introduction",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "",
    "text": "are the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nif the answer is NO, where and when the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#importing-packages",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#importing-packages",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "2.0 Importing Packages",
    "text": "2.0 Importing Packages\n\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#importing-datasets-into-environment",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#importing-datasets-into-environment",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "3.0 Importing Datasets into Environment",
    "text": "3.0 Importing Datasets into Environment\n\nimporting kbb shapefiles (geospatial)\n\n\nkbb_sf &lt;- st_read(dsn = \"data/rawdata\", \n                     layer=\"Kepulauan_Bangka_Belitung\") %&gt;%\n  st_union() %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 32748)\n\nReading layer `Kepulauan_Bangka_Belitung' from data source \n  `C:\\marcus159260\\IS415-GAA\\in-class_exercises\\in-class_ex04\\data\\rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 298 features and 27 fields\nGeometry type: POLYGON\nDimension:     XYZ\nBounding box:  xmin: 105.1085 ymin: -3.116593 xmax: 106.8488 ymax: -1.501603\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nst_as_s2(): dropping Z and/or M coordinate\n\n\n\nImporting and Preparing Forest Fire data (aspatial)\n\nfire &lt;- read_csv(\"data/rawdata/forestfires.csv\")\n\nRows: 741 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (3): satellite, instrument, daynight\ndbl  (11): latitude, longitude, brightness, scan, track, acq_time, confidenc...\ndate  (1): acq_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nfire_sf &lt;- read_csv(\"data/rawdata/forestfires.csv\") %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"),\n           crs = 4326) %&gt;%\n  st_transform(crs=32748)\n\nRows: 741 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (3): satellite, instrument, daynight\ndbl  (11): latitude, longitude, brightness, scan, track, acq_time, confidenc...\ndate  (1): acq_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#owin-object-transformation",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#owin-object-transformation",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "4.0 owin Object Transformation",
    "text": "4.0 owin Object Transformation\n\nconvert to owin (as.owin())\n\nkbb_owin &lt;- as.owin(kbb_sf)\nkbb_owin\n\nwindow: polygonal boundary\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units\n\n\n\nclass(kbb_owin)\n\n[1] \"owin\""
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#data-wrangling",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#data-wrangling",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "5.0 Data Wrangling",
    "text": "5.0 Data Wrangling\n\n5.1 mutate\n\nwhy do we need to convert (mutate) data type of acq_date to numeric?\n\nbecause ppp object only accept numerical or character as mark\n\n\n\nfire_sf_mutated_date &lt;- fire_sf %&gt;%\n  mutate(DayofYear = yday(acq_date)) %&gt;%\n  mutate(Month_num = month(acq_date)) %&gt;%\n  mutate(Month_fac = month(acq_date, \n                           label = TRUE,\n                           abbr= FALSE))\n\n\n\n5.2 Plot / VIsualising spatial points\n\nVisualising geographic distribution of forest fire points all throughout\n\ntm_shape(kbb_sf) +   \n  tm_polygons() +    \n    tm_shape(fire_sf_mutated_date) +    \n      tm_dots()\n\n\n\n\n\n\n\n\n{r}\nVisualising geographic distribution of forest fire points by month\n\ntm_shape(kbb_sf) +   \n  tm_polygons() +    \n    tm_shape(fire_sf_mutated_date) +    \n      tm_dots(size = 0.1) +    \n        tm_facets(by=\"Month_fac\",              \n                  free.coords = FALSE,             \n                  drop.units = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n5.3 computing STKDE by Month (time series KDE)\n\nfire_month &lt;- fire_sf_mutated_date %&gt;%   \n  select(Month_num)\n\n\nfire_month_ppp &lt;- as.ppp(fire_month) \nfire_month_ppp\n\nMarked planar point pattern: 741 points\nmarks are numeric, of storage type  'double'\nwindow: rectangle = [521564.1, 695791] x [9658137, 9828767] units\n\n\n\n\n5.4 summary + check for duplicates\n\nsummary(fire_month_ppp)\n\nMarked planar point pattern:  741 points\nAverage intensity 2.49258e-08 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   8.000   9.000   8.579  10.000  12.000 \n\nWindow: rectangle = [521564.1, 695791] x [9658137, 9828767] units\n                    (174200 x 170600 units)\nWindow area = 29728200000 square units\n\n\n\nany(duplicated(fire_month_ppp))\n\n[1] FALSE\n\n\n\n\n5.5 include created owin object\n\ncombining origin_am_ppp and am_owin objects\n\nfire_month_ppp + kbb_owin\n\n\n\nfire_month_owin &lt;- fire_month_ppp[kbb_owin]\nsummary(fire_month_owin)\n\nMarked planar point pattern:  741 points\nAverage intensity 6.424519e-08 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   8.000   9.000   8.579  10.000  12.000 \n\nWindow: polygonal boundary\n2 separate polygons (no holes)\n           vertices        area relative.area\npolygon 1     47493 11533600000      1.00e+00\npolygon 2       256      306427      2.66e-05\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units\n                     (193500 x 178600 units)\nWindow area = 11533900000 square units\nFraction of frame area: 0.334\n\n\n\nplot(fire_month_owin)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#compute-spatio-temporal-kde",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#compute-spatio-temporal-kde",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "6.0 Compute Spatio-temporal KDE",
    "text": "6.0 Compute Spatio-temporal KDE\n\nuse spattemp.density() from sparr package, to compute the STKDE\n\n\nst_kde &lt;- spattemp.density(fire_month_owin)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(st_kde)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 15102.47 (spatial)\n  lambda = 0.0304 (temporal)\n\nNo. of observations\n  741 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512066.8, 705559.4] x [9655398, 9834006]\n\nTemporal bound\n  [1, 12]\n\nEvaluation\n  128 x 128 x 12 trivariate lattice\n  Density range: [1.233458e-27, 8.202976e-10]"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#plotting-spatio-temporal-kde-object",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#plotting-spatio-temporal-kde-object",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "7.0 Plotting Spatio-temporal KDE object",
    "text": "7.0 Plotting Spatio-temporal KDE object\n\nplots KDE between July 2023 - December 2023\n\n\ntims &lt;- c(7,8,9,10,11,12) \npar(mfcol=c(2,3)) \nfor(i in tims) {\n  plot(st_kde, 1,         \n  override.par=FALSE,        \n  fix.range=TRUE,        \n  main=paste(\"KDE at month\", 1)) \n}"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#computing-stkde-by-day-of-year",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#computing-stkde-by-day-of-year",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "8.0 Computing STKDE by Day of Year",
    "text": "8.0 Computing STKDE by Day of Year\n\n8.1 Create ppp object\n\nfire_yday_ppp &lt;- fire_sf_mutated_date %&gt;% \n  select(DayofYear) %&gt;%\n  as.ppp()\n\n\n\n8.2 Combine both ppp object + owin object (kbb) = combined owin object\n\nfire_yday_owin &lt;- fire_yday_ppp[kbb_owin]\nsummary(fire_yday_owin)\n\nMarked planar point pattern:  741 points\nAverage intensity 6.424519e-08 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   10.0   213.0   258.0   245.9   287.0   352.0 \n\nWindow: polygonal boundary\n2 separate polygons (no holes)\n           vertices        area relative.area\npolygon 1     47493 11533600000      1.00e+00\npolygon 2       256      306427      2.66e-05\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units\n                     (193500 x 178600 units)\nWindow area = 11533900000 square units\nFraction of frame area: 0.334\n\n\n\n\n8.3 Compute STKDE by day of Year\n\nkde_yday &lt;- spattemp.density(fire_yday_owin)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(kde_yday)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 15102.47 (spatial)\n  lambda = 6.3198 (temporal)\n\nNo. of observations\n  741 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512066.8, 705559.4] x [9655398, 9834006]\n\nTemporal bound\n  [10, 352]\n\nEvaluation\n  128 x 128 x 343 trivariate lattice\n  Density range: [3.959516e-27, 2.751287e-12]"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#plot-stkde-by-day-of-year",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#plot-stkde-by-day-of-year",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "9.0 Plot STKDE by day of Year",
    "text": "9.0 Plot STKDE by day of Year\n\ntemporal bound: t=10 to 352\n\n\nplot(kde_yday)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/in-class_Ex04.html#references",
    "href": "in-class_exercises/in-class_ex04/in-class_Ex04.html#references",
    "title": "In-class Exercise 04: Forest Fire in Kepulauan Bangka Belitung, Indonesia (Spatio-temporal Point Patterns Analysis",
    "section": "References",
    "text": "References\n\ntmap: https://r-tmap.github.io/tmap/reference/index.html\nsparr: https://cran.r-project.org/web/packages/sparr/index.html"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "",
    "text": "Focus on:\n\nTobler’s First law of Geography\nPrinciples of Spatial Autocorrelation\nConcepts of Spatial Proximity and Spatial Weights\n\nContiguity-Based Spatial Weights: Rook’s & Queen’s\nDistance-Band Spatial Weights: fixed and adaptive\n\nApplications of Spatial Weights\n\nSpatially Lagged Variables\nGeographically Weighted Summary Statistics"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#introduction",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#introduction",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "",
    "text": "Focus on:\n\nTobler’s First law of Geography\nPrinciples of Spatial Autocorrelation\nConcepts of Spatial Proximity and Spatial Weights\n\nContiguity-Based Spatial Weights: Rook’s & Queen’s\nDistance-Band Spatial Weights: fixed and adaptive\n\nApplications of Spatial Weights\n\nSpatially Lagged Variables\nGeographically Weighted Summary Statistics"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#importing-packages",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#importing-packages",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "2.0 Importing Packages",
    "text": "2.0 Importing Packages\n\nsf: import geospatial data\nreadr: import csv file (tidyverse package)\ndplyr: perform relational join\nspdep: compute spatial weights, calculate spatially lagged variables\ntmap: plotting and visualisation\nknitr:\n\n\npacman::p_load(sf, spdep, tmap, tidyverse, knitr)"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#importing-datasets-into-environment",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#importing-datasets-into-environment",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "3.0 Importing Datasets into Environment",
    "text": "3.0 Importing Datasets into Environment\n\ngeospatial (boundary data)\n\nhunan_sf &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\marcus159260\\IS415-GAA\\hands-on-exercises\\Hands-on_Ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\naspatial\n\nhunan2012_sf &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhunan2012_sf\n\n# A tibble: 88 × 29\n   County    City   avg_wage deposite    FAI Gov_Rev Gov_Exp    GDP GDPPC    GIO\n   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n 1 Anhua     Yiyang    30544   10967   6832.    457.   2703  13225  14567  9277.\n 2 Anren     Chenz…    28058    4599.  6386.    221.   1455.  4941. 12761  4189.\n 3 Anxiang   Chang…    31935    5517.  3541     244.   1780. 12482  23667  5109.\n 4 Baojing   Hunan…    30843    2250   1005.    193.   1379.  4088. 14563  3624.\n 5 Chaling   Zhuzh…    31251    8241.  6508.    620.   1947  11585  20078  9158.\n 6 Changning Hengy…    28518   10860   7920     770.   2632. 19886  24418 37392 \n 7 Changsha  Chang…    54540   24332  33624    5350    7886. 88009  88656 51361 \n 8 Chengbu   Shaoy…    28597    2581.  1922.    161.   1192.  2570. 10132  1681.\n 9 Chenxi    Huaih…    33580    4990   5818.    460.   1724.  7755. 17026  6644.\n10 Cili      Zhang…    33099    8117.  4498.    500.   2306. 11378  18714  5843.\n# ℹ 78 more rows\n# ℹ 19 more variables: Loan &lt;dbl&gt;, NIPCR &lt;dbl&gt;, Bed &lt;dbl&gt;, Emp &lt;dbl&gt;,\n#   EmpR &lt;dbl&gt;, EmpRT &lt;dbl&gt;, Pri_Stu &lt;dbl&gt;, Sec_Stu &lt;dbl&gt;, Household &lt;dbl&gt;,\n#   Household_R &lt;dbl&gt;, NOIP &lt;dbl&gt;, Pop_R &lt;dbl&gt;, RSCG &lt;dbl&gt;, Pop_T &lt;dbl&gt;,\n#   Agri &lt;dbl&gt;, Service &lt;dbl&gt;, Disp_Inc &lt;dbl&gt;, RORP &lt;dbl&gt;, ROREmp &lt;dbl&gt;"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#projection-transformation",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#projection-transformation",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "4.0 Projection Transformation",
    "text": "4.0 Projection Transformation\n\nst_crs(hunan_sf)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\n\nst_crs(hunan2012_sf)\n\nCoordinate Reference System: NA"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#data-wrangling",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#data-wrangling",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "5.0 Data Wrangling",
    "text": "5.0 Data Wrangling\n\nPerform Relational Join\n\nleft_join (from dplyr package) to join by same column (County)\n\n\n\nhunan &lt;- left_join(hunan_sf, hunan2012_sf, join_by(County)) %&gt;%\n  select(1:4, 7, 15)\n\n#how do i know to pick column 15? if i were to pick 8 (last column), there will be:\n  #Error: Fill argument neither colors nor valid variable name(s)\n\n#pick 6 columns (1:4, 7, 15) gives back 7 columns? (GDPPC)"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#exploratory-spatial-data-analysis",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#exploratory-spatial-data-analysis",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "6.0 Exploratory Spatial Data Analysis",
    "text": "6.0 Exploratory Spatial Data Analysis\n\nVisualising Regional Development Indicator\n\nthrough basemap and choropleth map , to show distribution of GDPPC 2012 by using qtm() of tmap package.\n\n\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.4)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\", fill.palette = \"plasma\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#computing-contiguity-spatial-weights",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#computing-contiguity-spatial-weights",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "7.0 Computing Contiguity Spatial Weights",
    "text": "7.0 Computing Contiguity Spatial Weights\n\nuse poly2nb (from spdep package) to compute contiguity weight matrices for the study area\n\npoly2nb accepts arguement (queen), which sets boolean (TRUE or FALSE), identifying neighbouring regions.\ndefault: queen = TRUE, will generate list of first-order neighbours\n\n7.1 Computing QUEEN contiguity-based neighbours\n\nweight matrices\n\n\n\nwm_q &lt;- poly2nb(hunan, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\nregions = area units\n(polygon id) 85 is polygon 85 has 11 connected neighbours\n(polygon id) 30 and 65: has 1 connected regions (the least)\nSee connected neighbours of first polygon object\n\nPolygon 1 has 5 neighbours\n\n\nwm_q[[1]]\n\n[1]  2  3  4 57 85\n\n\n\nCounty name of Polygon 1\n\n\nhunan$County[1]\n\n[1] \"Anxiang\"\n\n\n\nCounty names of connected neighbours of Polygon 1\n\n\nhunan$NAME_3[wm_q[[1]]]\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n#or just copy the column numbers from above\n\n# hunan$NAME_3[c(2,3,4,57,85)]\n\n\nGDPCC of the 5 neighbours\n\n\nGDPCC_poly1 = hunan$GDPPC[wm_q[[1]]]\nGDPCC_poly1\n\n[1] 20981 34592 24473 21311 22879\n\n\n\ndisplay complete weight matrix, using str() function\n\nto see the connected neighbours of all 88 polygons\n\n\n\nstr(wm_q)\n\nList of 88\n $ : int [1:5] 2 3 4 57 85\n $ : int [1:5] 1 57 58 78 85\n $ : int [1:4] 1 4 5 85\n $ : int [1:4] 1 3 5 6\n $ : int [1:4] 3 4 6 85\n $ : int [1:5] 4 5 69 75 85\n $ : int [1:4] 67 71 74 84\n $ : int [1:7] 9 46 47 56 78 80 86\n $ : int [1:6] 8 66 68 78 84 86\n $ : int [1:8] 16 17 19 20 22 70 72 73\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:3] 11 15 17\n $ : int [1:4] 13 14 17 83\n $ : int [1:5] 10 17 22 72 83\n $ : int [1:7] 10 11 14 15 16 72 83\n $ : int [1:5] 20 22 23 77 83\n $ : int [1:6] 10 20 21 73 74 86\n $ : int [1:7] 10 18 19 21 22 23 82\n $ : int [1:5] 19 20 35 82 86\n $ : int [1:5] 10 16 18 20 83\n $ : int [1:7] 18 20 38 41 77 79 82\n $ : int [1:5] 25 28 31 32 54\n $ : int [1:5] 24 28 31 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:3] 26 29 42\n $ : int [1:5] 24 25 33 49 54\n $ : int [1:3] 27 37 42\n $ : int 33\n $ : int [1:8] 24 25 32 36 39 40 56 81\n $ : int [1:8] 24 31 50 54 55 56 75 85\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 47 80 82 86\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:4] 29 42 43 44\n $ : int [1:4] 23 44 77 79\n $ : int [1:5] 31 40 42 43 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:7] 26 27 29 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:4] 37 38 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:3] 8 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:5] 32 48 52 54 55\n $ : int [1:3] 48 49 52\n $ : int [1:5] 48 49 50 51 54\n $ : int [1:3] 48 55 75\n $ : int [1:6] 24 28 32 49 50 52\n $ : int [1:5] 32 48 50 53 75\n $ : int [1:7] 8 31 32 36 78 80 85\n $ : int [1:6] 1 2 58 64 76 85\n $ : int [1:5] 2 57 68 76 78\n $ : int [1:4] 60 61 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:7] 12 59 60 62 63 77 87\n $ : int [1:3] 61 77 87\n $ : int [1:4] 12 61 77 83\n $ : int [1:2] 57 76\n $ : int 76\n $ : int [1:5] 9 67 68 76 84\n $ : int [1:4] 7 66 76 84\n $ : int [1:5] 9 58 66 76 78\n $ : int [1:3] 6 75 85\n $ : int [1:3] 10 72 73\n $ : int [1:3] 7 73 74\n $ : int [1:5] 10 11 16 17 70\n $ : int [1:5] 10 19 70 71 74\n $ : int [1:6] 7 19 71 73 84 86\n $ : int [1:6] 6 32 53 55 69 85\n $ : int [1:7] 57 58 64 65 66 67 68\n $ : int [1:7] 18 23 38 61 62 63 83\n $ : int [1:7] 2 8 9 56 58 68 85\n $ : int [1:7] 23 38 40 41 43 44 45\n $ : int [1:8] 8 34 35 36 41 45 47 56\n $ : int [1:6] 25 26 31 33 39 42\n $ : int [1:5] 20 21 23 35 41\n $ : int [1:9] 12 13 15 16 17 18 22 63 77\n $ : int [1:6] 7 9 66 67 74 86\n $ : int [1:11] 1 2 3 5 6 32 56 57 69 75 ...\n $ : int [1:9] 8 9 19 21 35 46 47 74 84\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language poly2nb(pl = hunan, queen = TRUE)\n - attr(*, \"type\")= chr \"queen\"\n - attr(*, \"snap\")= num 9e-08\n - attr(*, \"sym\")= logi TRUE\n - attr(*, \"ncomp\")=List of 2\n  ..$ nc     : int 1\n  ..$ comp.id: int [1:88] 1 1 1 1 1 1 1 1 1 1 ...\n\n\n7.2 Computing ROOK contiguity-based neighbours\n\nuse wm_r to create another set of neighbours\n\n\nwm_r &lt;- poly2nb(hunan, queen=FALSE)\nsummary(wm_r)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\n7.3 Visualising Contiguity Weights\n\nlongitude\n\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncbind\n\nextract and bind coordinates of the centroid of each area unit\n\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\nhead(coords)\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n7.3.1 Plotting QUEEN contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"grey\")\n\n\n\n\n\n\n\n\n7.3.2 Plotting ROOK contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"grey\")\n\n\n\n\n\n\n\n\n7.3.3 Plotting QUEEN and ROOK contiguity based neighbours map\n\npar(mar = c(0,0,1,0),mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"grey\")\nplot(hunan$geometry, border=\"lightgrey\", main=\"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"grey\")"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#computing-distance-based-neighbours",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#computing-distance-based-neighbours",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "8.0 Computing Distance Based Neighbours",
    "text": "8.0 Computing Distance Based Neighbours\n\nDerive distance-based weight matrices using dnearneigh() from spdep package\nThe function identifies neighbours of region points by Euclidean distance with a distance band with lower d1= and upper d2= bounds controlled by the bounds= argument. If unprojected coordinates are used and either specified in the coordinates object x or with x as a two column matrix and longlat=TRUE, great circle distances in km will be calculated assuming the WGS84 reference ellipsoid.\n8.1 Determine Cut-Off Distance\nWe need to determine the upper limit for the distance band:\n\nReturn a matrix with the indices of points belonging to the set of the k nearest neighbours of each other by using knearneigh() of spdep.\nConvert the knn object returned by knearneigh() into a neighbours list of class nb with a list of integer vectors containing neighbour region number ids by using knn2nb().\nReturn the length of neighbour relationship edges by using nbdists() of spdep. The function returns in the units of the coordinates if the coordinates are projected, in km otherwise.\nRemove the list structure of the returned object by using unlist().\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\n\nWarning in knn2nb(knearneigh(coords)): neighbour object has 25 sub-graphs\n\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n8.2 Computing Fixed Distance weight matrix\nCompute the distance weight matrix using dnearneigh()\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\nQuiz: What is the meaning of “Average number of links: 3.681818” shown above?\n\nIt means within a distance range of 0-62km, each region has 3-4 (3.68) neighboring regions.\n\nDisplay the content of wm_62 matrix using str()\n\nstr(wm_d62)\n\nList of 88\n $ : int [1:5] 3 4 5 57 64\n $ : int [1:4] 57 58 78 85\n $ : int [1:4] 1 4 5 57\n $ : int [1:3] 1 3 5\n $ : int [1:4] 1 3 4 85\n $ : int 69\n $ : int [1:2] 67 84\n $ : int [1:4] 9 46 47 78\n $ : int [1:4] 8 46 68 84\n $ : int [1:4] 16 22 70 72\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:2] 11 17\n $ : int 13\n $ : int [1:4] 10 17 22 83\n $ : int [1:3] 11 14 16\n $ : int [1:3] 20 22 63\n $ : int [1:5] 20 21 73 74 82\n $ : int [1:5] 18 19 21 22 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:4] 10 16 18 20\n $ : int [1:3] 41 77 82\n $ : int [1:4] 25 28 31 54\n $ : int [1:4] 24 28 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:2] 26 29\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:2] 27 37\n $ : int 33\n $ : int [1:2] 24 36\n $ : int 50\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:5] 31 34 45 56 80\n $ : int [1:2] 29 42\n $ : int [1:3] 44 77 79\n $ : int [1:4] 40 42 43 81\n $ : int [1:3] 39 45 79\n $ : int [1:5] 23 35 45 79 82\n $ : int [1:5] 26 37 39 43 81\n $ : int [1:3] 39 42 44\n $ : int [1:2] 38 43\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:5] 8 9 35 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:4] 48 49 50 52\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:2] 48 55\n $ : int [1:5] 24 28 49 50 52\n $ : int [1:4] 48 50 53 75\n $ : int 36\n $ : int [1:5] 1 2 3 58 64\n $ : int [1:5] 2 57 64 66 68\n $ : int [1:3] 60 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:5] 12 60 62 63 87\n $ : int [1:4] 61 63 77 87\n $ : int [1:5] 12 18 61 62 83\n $ : int [1:4] 1 57 58 76\n $ : int 76\n $ : int [1:5] 58 67 68 76 84\n $ : int [1:2] 7 66\n $ : int [1:4] 9 58 66 84\n $ : int [1:2] 6 75\n $ : int [1:3] 10 72 73\n $ : int [1:2] 73 74\n $ : int [1:3] 10 11 70\n $ : int [1:4] 19 70 71 74\n $ : int [1:5] 19 21 71 73 86\n $ : int [1:2] 55 69\n $ : int [1:3] 64 65 66\n $ : int [1:3] 23 38 62\n $ : int [1:2] 2 8\n $ : int [1:4] 38 40 41 45\n $ : int [1:5] 34 35 36 45 47\n $ : int [1:5] 25 26 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:4] 12 13 16 63\n $ : int [1:4] 7 9 66 68\n $ : int [1:2] 2 5\n $ : int [1:4] 21 46 47 74\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 62, longlat = TRUE)\n - attr(*, \"dnn\")= num [1:2] 0 62\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n - attr(*, \"ncomp\")=List of 2\n  ..$ nc     : int 1\n  ..$ comp.id: int [1:88] 1 1 1 1 1 1 1 1 1 1 ...\n\n\nAnother way to display the structure of the weight matrix is to combine table() and card() of spdep.\n\ntable(hunan$County, card(wm_d62))\n\n\n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\nn_comp &lt;- n.comp.nb(wm_d62)\nn_comp$nc\n\n[1] 1\n\n\n\ntable(n_comp$comp.id)\n\n\n 1 \n88 \n\n\n8.3 Plotting fixed distance weight matrix\n\nRed lines show links of first-nearest neighbours\nBlack lines show links of neighbours within the cut-off distance range of 62km\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n\n\n\n\n8.3.1 Separate 1st-nearest neighbours (red) and other neighbours within range (black)\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"1st nearest neighbours\")\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\nplot(hunan$geometry, border=\"lightgrey\", main=\"Other neighbours\")\nplot(wm_d62, coords, add=TRUE, pch = 19, cex = 0.6)\n\n\n\n\n\n\n\n\n8.4 Computing adaptive distance weight matrix\n\nknn6 &lt;- knn2nb(knearneigh(coords, k=6))\nknn6\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\n\nstr(knn6)\n\nList of 88\n $ : int [1:6] 2 3 4 5 57 64\n $ : int [1:6] 1 3 57 58 78 85\n $ : int [1:6] 1 2 4 5 57 85\n $ : int [1:6] 1 3 5 6 69 85\n $ : int [1:6] 1 3 4 6 69 85\n $ : int [1:6] 3 4 5 69 75 85\n $ : int [1:6] 9 66 67 71 74 84\n $ : int [1:6] 9 46 47 78 80 86\n $ : int [1:6] 8 46 66 68 84 86\n $ : int [1:6] 16 19 22 70 72 73\n $ : int [1:6] 10 14 16 17 70 72\n $ : int [1:6] 13 15 60 61 63 83\n $ : int [1:6] 12 15 60 61 63 83\n $ : int [1:6] 11 15 16 17 72 83\n $ : int [1:6] 12 13 14 17 60 83\n $ : int [1:6] 10 11 17 22 72 83\n $ : int [1:6] 10 11 14 16 72 83\n $ : int [1:6] 20 22 23 63 77 83\n $ : int [1:6] 10 20 21 73 74 82\n $ : int [1:6] 18 19 21 22 23 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:6] 10 16 18 19 20 83\n $ : int [1:6] 18 20 41 77 79 82\n $ : int [1:6] 25 28 31 52 54 81\n $ : int [1:6] 24 28 31 33 54 81\n $ : int [1:6] 25 27 29 33 42 81\n $ : int [1:6] 26 29 30 37 42 81\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:6] 26 27 37 42 43 81\n $ : int [1:6] 26 27 28 33 49 81\n $ : int [1:6] 24 25 36 39 40 54\n $ : int [1:6] 24 31 50 54 55 56\n $ : int [1:6] 25 26 28 30 49 81\n $ : int [1:6] 36 40 41 45 56 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:6] 26 27 29 42 43 44\n $ : int [1:6] 23 43 44 62 77 79\n $ : int [1:6] 25 40 42 43 44 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:6] 26 27 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:6] 37 38 39 42 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:6] 8 9 35 47 78 86\n $ : int [1:6] 8 21 35 46 80 86\n $ : int [1:6] 49 50 51 52 53 55\n $ : int [1:6] 28 33 48 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:6] 28 48 49 50 52 54\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:6] 48 50 51 52 55 75\n $ : int [1:6] 24 28 49 50 51 52\n $ : int [1:6] 32 48 50 52 53 75\n $ : int [1:6] 32 34 36 78 80 85\n $ : int [1:6] 1 2 3 58 64 68\n $ : int [1:6] 2 57 64 66 68 78\n $ : int [1:6] 12 13 60 61 87 88\n $ : int [1:6] 12 13 59 61 63 87\n $ : int [1:6] 12 13 60 62 63 87\n $ : int [1:6] 12 38 61 63 77 87\n $ : int [1:6] 12 18 60 61 62 83\n $ : int [1:6] 1 3 57 58 68 76\n $ : int [1:6] 58 64 66 67 68 76\n $ : int [1:6] 9 58 67 68 76 84\n $ : int [1:6] 7 65 66 68 76 84\n $ : int [1:6] 9 57 58 66 78 84\n $ : int [1:6] 4 5 6 32 75 85\n $ : int [1:6] 10 16 19 22 72 73\n $ : int [1:6] 7 19 73 74 84 86\n $ : int [1:6] 10 11 14 16 17 70\n $ : int [1:6] 10 19 21 70 71 74\n $ : int [1:6] 19 21 71 73 84 86\n $ : int [1:6] 6 32 50 53 55 69\n $ : int [1:6] 58 64 65 66 67 68\n $ : int [1:6] 18 23 38 61 62 63\n $ : int [1:6] 2 8 9 46 58 68\n $ : int [1:6] 38 40 41 43 44 45\n $ : int [1:6] 34 35 36 41 45 47\n $ : int [1:6] 25 26 28 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:6] 12 13 15 16 22 63\n $ : int [1:6] 7 9 66 68 71 74\n $ : int [1:6] 2 3 4 5 56 69\n $ : int [1:6] 8 9 21 46 47 74\n $ : int [1:6] 59 60 61 62 63 88\n $ : int [1:6] 59 60 61 62 63 87\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language knearneigh(x = coords, k = 6)\n - attr(*, \"sym\")= logi FALSE\n - attr(*, \"type\")= chr \"knn\"\n - attr(*, \"knn-k\")= num 6\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"ncomp\")=List of 2\n  ..$ nc     : int 1\n  ..$ comp.id: int [1:88] 1 1 1 1 1 1 1 1 1 1 ...\n\n\n\nCan see that exactly 6 neighbours\n\n8.5 Plotting\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#kernel-density-estimation",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#kernel-density-estimation",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "9.0 Kernel Density Estimation",
    "text": "9.0 Kernel Density Estimation"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#conclusion",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#conclusion",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "10.0 Conclusion",
    "text": "10.0 Conclusion"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#references",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#references",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#importing-packages",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#importing-packages",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "2.0 Importing Packages",
    "text": "2.0 Importing Packages\n\nsf\nraster\nspatstat\nsparr\ntmap\ntidyverse\n\n\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse)"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#importing-datasets-into-environment",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#importing-datasets-into-environment",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "3.0 Importing Datasets into Environment",
    "text": "3.0 Importing Datasets into Environment\n\ngeospatial\naspatial (csv)\n\nmyanmar_sf &lt;- read_csv(\"data/aspatial/2021-01-01-2024-06-30-Myanmar.csv\")\n\nRows: 51553 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nmyanmar_sf\n\n# A tibble: 51,553 × 31\n   event_id_cnty event_date    year time_precision disorder_type      event_type\n   &lt;chr&gt;         &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt;     \n 1 MMR64313      30 June 2024  2024              1 Political violence Battles   \n 2 MMR64320      30 June 2024  2024              1 Political violence Battles   \n 3 MMR64321      30 June 2024  2024              1 Political violence Battles   \n 4 MMR64322      30 June 2024  2024              1 Strategic develop… Strategic…\n 5 MMR64323      30 June 2024  2024              1 Political violence Battles   \n 6 MMR64324      30 June 2024  2024              1 Strategic develop… Strategic…\n 7 MMR64325      30 June 2024  2024              1 Political violence Battles   \n 8 MMR64326      30 June 2024  2024              1 Political violence Battles   \n 9 MMR64328      30 June 2024  2024              1 Political violence Battles   \n10 MMR64330      30 June 2024  2024              1 Political violence Battles   \n# ℹ 51,543 more rows\n# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;,\n#   source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;, …\n\n\n\nmyanmar_sf &lt;- read_csv(\"data/aspatial/2021-01-01-2024-06-30-Myanmar.csv\") %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"),\n           crs = 4326) %&gt;%\n  st_transform(crs=32748)\n\nRows: 51553 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#projection-transformation",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#projection-transformation",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "4.0 Projection Transformation",
    "text": "4.0 Projection Transformation"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#data-wrangling",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#data-wrangling",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "5.0 Data Wrangling",
    "text": "5.0 Data Wrangling"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#exploratory-spatial-data-analysis",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#exploratory-spatial-data-analysis",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "6.0 Exploratory Spatial Data Analysis",
    "text": "6.0 Exploratory Spatial Data Analysis"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#measuring-dispersion",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#measuring-dispersion",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "7.0 Measuring Dispersion??",
    "text": "7.0 Measuring Dispersion??"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#first-ordersecond-order-sppa",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#first-ordersecond-order-sppa",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "8.0 First Order/Second Order SPPA",
    "text": "8.0 First Order/Second Order SPPA"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#kernel-density-estimation",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#kernel-density-estimation",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "9.0 Kernel Density Estimation",
    "text": "9.0 Kernel Density Estimation"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#conclusion",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#conclusion",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "10.0 Conclusion",
    "text": "10.0 Conclusion"
  },
  {
    "objectID": "take-home_exercises/take-home_ex01/take-home_Ex01.html#references",
    "href": "take-home_exercises/take-home_ex01/take-home_Ex01.html#references",
    "title": "Take-home Exercise 1: Geospatial Analytics for Social Good - Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "in-class_exercises/in-class_ex04/data/rawdata/Kepulauan_Bangka_Belitung.html",
    "href": "in-class_exercises/in-class_ex04/data/rawdata/Kepulauan_Bangka_Belitung.html",
    "title": "IS415-GAA",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     \n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#spatial-weights-based-on-inverse-distance-weighted-idw-method",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#spatial-weights-based-on-inverse-distance-weighted-idw-method",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "9.0 Spatial Weights based on Inverse Distance Weighted (IDW) method",
    "text": "9.0 Spatial Weights based on Inverse Distance Weighted (IDW) method\n\nDerive a spatial weight matrix based on Inverse Distance Weighted (IDW) method\n9.1 Compute the distance between areas using nbdists() of spdep\n\ndist &lt;- nbdists(wm_q, coords, longlat = TRUE)\nids &lt;- lapply(dist, function(x) 1/(x))\n\n9.2 Row-standardised weights matrix\n\nWe need to assign weights to each neighbouring polygon (assigned equal weight of (style=“W”)).\nThis is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.\nother styles:\n\nstyle=“B”\n\nzero.policy = TRUE, allows for lists of non-neighbours.\nThis should be used with caution since the user may not be aware of missing neighbors in their dataset however, a zero.policy of FALSE would return an error.\n\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\nSee the weight of the first polygon’s 8 neighbours type:\n\nrswm_q$weights[10]\n\n[[1]]\n[1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125\n\n\n\nSo here each neighbour is assigned equal weight of 0.125 of the total weight. This means that when R computes the average neighboring income values, each neighbor’s income will be multiplied by 0.125 before being tallied.\n\nDerive a row standardised weight matrix\n\nrswm_ids &lt;- nb2listw(wm_q, glist=ids, style=\"B\", zero.policy=TRUE)\nrswm_ids\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn       S0        S1     S2\nB 88 7744 8.786867 0.3776535 3.8137\n\n\n\nrswm_ids$weights[1]\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n\n\nsummary(unlist(rswm_ids$weights))\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.008218 0.015088 0.018739 0.019614 0.022823 0.040338"
  },
  {
    "objectID": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#application-of-spatial-weight-matrix",
    "href": "hands-on-exercises/Hands-on_Ex05/hands-on-ex5.html#application-of-spatial-weight-matrix",
    "title": "Hands-on-Exercise 5: Spatial Weights and Applications",
    "section": "10.0 Application of Spatial Weight Matrix",
    "text": "10.0 Application of Spatial Weight Matrix\n\nWhat are spatial lagged variables?\n\nWith a neighbor structure defined by the non-zero elements of the spatial weights matrix W, a spatially lagged variable is a weighted sum or a weighted average of the neighboring values for that variable. In most commonly used notation, the spatial lag of y is then expressed as Wy.\n\n\n\n\nExplore 4 different spatial lagged variables:\n\nspatial lag with row-standardized weights\nspatial lag as a sum of neighbouring values\nspatial window average\nspatial window sum.\n\n\n\n10.1 Spatial lag with row-standardized weights\n\nCompute the average neighbor GDPPC value for each polygon. These values are often referred to as spatially lagged values.\n\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\n\nwe got the GDPPC of 5 neighbouring regions of the first polygon (Anxiang county)\n\n\nGDPCC_poly1 = hunan$GDPPC[wm_q[[1]]]\nGDPCC_poly1\n\n[1] 20981 34592 24473 21311 22879\n\n\nWe can append the spatially lag GDPPC values onto hunan sf data frame through following steps.\n\nFirst, we will create a variable called lag.list\nThen, we will calculate the spatial lag value using lag.listw() function that takes in the spatial weights matrix rswm_q, and the GDPPC values for each region in the hunan dataframe, hunan$GDPPC.\nNext, we will convert lag.list into a dataframe named lag.res\nFinally, we will use left_join() function from the dplyr package to merge the hunan dataframe with lag.res dataframe.\n\n\nlag.list &lt;- list(hunan$NAME_3, lag.listw(rswm_q, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag.list)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag GDPPC\")\nhunan &lt;- left_join(hunan,lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3  County GDPPC lag GDPPC\n1 Changde 21098 Anxiang      County Anxiang 23667  24847.20\n2 Changde 21100 Hanshou      County Hanshou 20981  22724.80\n3 Changde 21101  Jinshi County City  Jinshi 34592  24143.25\n4 Changde 21102      Li      County      Li 24473  27737.50\n5 Changde 21103   Linli      County   Linli 25554  27270.25\n6 Changde 21104  Shimen      County  Shimen 27137  21248.80\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\nPlot both the GDPPC and spatial lag GDPPC for comparison \n\ngdppc &lt;- qtm(hunan, \"GDPPC\", fill.palette = \"plasma\")\nlag_gdppc &lt;- qtm(hunan, \"lag GDPPC\",fill.palette = \"plasma\")\ntmap_arrange(gdppc, lag_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\n\n10.2 Spatial lag as a sum of neighbouring values\nThis spatial lag measure do not consider spatial weights, but simply sums up the values of the variable for all the neighbouring regions.\nWe can calculate spatial lag as a sum of neighboring values by assigning binary weights. This requires us to go back to our neighbors list, then apply a function that will assign binary weights, then we use glist argument in the nb2listw function to explicitly assign these weights.\n\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\n1. With the proper weights assigned, we can use lag.listw to compute a lag variable from our weight and GDPPC.\n\nlag_sum &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag_sum)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag_sum GDPPC\")\n\n\nlag_sum\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\n\nNext, we will append the lag_sum GDPPC field into hunan sf data frame\n\n\nhunan &lt;- left_join(hunan, lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\nPlot both the GDPPC and Spatial Lag Sum GDPPC for comparison\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum GDPPC\", fill.palette=\"plasma\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\n10.3 Spatial window average\n\nUses row-standardized weights and includes the diagonal element. \n\nwe need to go back to the neighbors structure and add the diagonal element before assigning weights.\n\n\n\nAdd the diagonal element to the neighbours list using include.self() from spdep\n\nwm_qs &lt;- include.self(wm_q)\n\nNotice that the Number of nonzero links, Percentage nonzero weights and Average number of links are 536, 6.921488 and 6.090909 respectively as compared to wm_q of 448, 5.785124 and 5.090909.\n\nTake a look at the neighbour list of Anxiang county (area[1])\n\nwm_qs[[1]]\n\n[1]  1  2  3  4 57 85\n\n\nNotice that now [1] has six neighbours instead of five.\nNow we obtain weights with nb2listw()\n\nwm_qs &lt;- nb2listw(wm_qs)\nwm_qs\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\n 2. create the lag variable from our weight structure and GDPPC variable.\n\nlag_w_avg_gpdpc &lt;- lag.listw(wm_qs, \n                             hunan$GDPPC)\nlag_w_avg_gpdpc\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\n\nConvert the lag variable listw object into a data.frame by using as.data.frame()\n\nlag.list.wm_qs &lt;- list(hunan$NAME_3, lag.listw(wm_qs, hunan$GDPPC))\nlag_wm_qs.res &lt;- as.data.frame(lag.list.wm_qs)\ncolnames(lag_wm_qs.res) &lt;- c(\"NAME_3\", \"lag_window_avg GDPPC\")\n\nAppend lag_window_avg GDPPC values onto hunan data.frame by using left_join() of dplyr package.\n\nhunan &lt;- left_join(hunan, lag_wm_qs.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nTo compare the values of lag GDPPC and Spatial window average, kable() of Knitr package is used to prepare a table using the code chunk below.\n\nhunan %&gt;%\n  select(\"County\", \n         \"lag GDPPC\", \n         \"lag_window_avg GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag GDPPC\nlag_window_avg GDPPC\ngeometry\n\n\n\n\nAnxiang\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n32671.00\n26627.50\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n20810.00\n22690.17\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n25711.50\n25366.40\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n30672.33\n25825.75\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n33457.75\n30329.00\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n31689.20\n32682.83\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n20269.00\n25948.62\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n23901.60\n23987.67\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n25126.17\n25463.14\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n21903.43\n21904.38\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n22718.60\n23127.50\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n25918.80\n25949.83\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n20307.00\n20018.75\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n20023.80\n19524.17\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n16576.80\n18955.00\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n18667.00\n17800.40\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n14394.67\n15883.00\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n19848.80\n18831.33\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n15516.33\n14832.50\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518.00\n17965.00\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n17572.00\n17159.89\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n15200.12\n16199.44\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n18413.80\n18764.50\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n14419.33\n26878.75\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n24094.50\n23188.86\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n22019.83\n20788.14\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n12923.50\n12365.20\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n14756.00\n15985.00\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n13869.80\n13764.83\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n12296.67\n11907.43\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n15775.17\n17128.14\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n14382.86\n14593.62\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n11566.33\n11644.29\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n13199.50\n12706.00\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n23412.00\n21712.29\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n39541.00\n43548.25\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n36186.60\n35049.00\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n16559.60\n16226.83\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n20772.50\n19294.40\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n19471.20\n18156.00\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n19827.33\n19954.75\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n15466.80\n18145.17\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n12925.67\n12132.75\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n18577.17\n18419.29\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n14943.00\n14050.83\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n24913.00\n23619.75\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n25093.00\n24552.71\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n24428.80\n24733.67\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n17003.00\n16762.60\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n21143.75\n20932.60\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n20435.00\n19467.75\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n17131.33\n18334.00\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n24569.75\n22541.00\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n23835.50\n26028.00\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360.00\n29128.50\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n47383.40\n46569.00\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n55157.75\n47576.60\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n37058.00\n36545.50\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n21546.67\n20838.50\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n23348.67\n22531.00\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n42323.67\n42115.50\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n28938.60\n27619.00\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n25880.80\n27611.33\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n47345.67\n44523.29\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n18711.33\n18127.43\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n29087.29\n28746.38\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n20748.29\n20734.50\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n35933.71\n33880.62\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n15439.71\n14716.38\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n29787.50\n28516.22\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n18145.00\n18086.14\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n21617.00\n21244.50\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n29203.89\n29568.80\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n41363.67\n48119.71\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n22259.09\n22310.75\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n44939.56\n43151.60\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n16902.00\n17133.40\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n16930.00\n17009.33\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\nPlot both the lag_gdppc and w_avg_gdppc maps next to each other for quick comparison.\n\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg GDPPC\", fill.palette = \"plasma\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\n\n10.4 Spatial window sum\nSimilar to the spatial window average, this measure sums up the values of a variable within a specified spatial window. When calculating spatial window sum, we do not need to use row-standardized weights.\nTo add the diagonal element to the neighbour list, we just need to use include.self() from spdep.\n\nwm_qs &lt;- include.self(wm_q)\nwm_qs\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\n\nAssign binary weights to the neighbour structure that includes the diagonal element.\n\nb_weights &lt;- lapply(wm_qs, function(x) 0*x + 1)\nb_weights[1]\n\n[[1]]\n[1] 1 1 1 1 1 1\n\n\nUse nb2listw() and glist() to explicitly assign weight values.\n\nb_weights2 &lt;- nb2listw(wm_qs, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\nWith our new weight structure, we can compute the lag variable with lag.listw() function.\n\nw_sum_gdppc &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nw_sum_gdppc\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\nConvert the lag variable listw object into a data.frame by using as.data.frame().\n\nw_sum_gdppc.res &lt;- as.data.frame(w_sum_gdppc)\ncolnames(w_sum_gdppc.res) &lt;- c(\"NAME_3\", \"w_sum GDPPC\")\n\nAppend w_sum GDPPC values onto hunan data.frame by using left_join() of dplyr package.\n\nhunan &lt;- left_join(hunan, w_sum_gdppc.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nTo compare the values of lag GDPPC and Spatial window average, kable() of Knitr package is used to prepare a table using the code chunk below\n\nhunan %&gt;%\n  select(\"County\", \"lag_sum GDPPC\", \"w_sum GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag_sum GDPPC\nw_sum GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n98013\n106510\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n104050\n136141\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n102846\n126832\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n92017\n103303\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n133831\n151645\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n158446\n196097\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n141883\n207589\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n119508\n143926\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n150757\n178242\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n153324\n175235\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n113593\n138765\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n129594\n155699\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n142149\n160150\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n100119\n117145\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n82884\n113730\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n74668\n89002\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n43184\n63532\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n99244\n112988\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n46549\n59330\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518\n35930\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n140576\n154439\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n121601\n145795\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n92069\n112587\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n43258\n107515\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n144567\n162322\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n132119\n145517\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n51694\n61826\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n59024\n79925\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n69349\n82589\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n73780\n83352\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n94651\n119897\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n100680\n116749\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n69398\n81510\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n52798\n63530\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n140472\n151986\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n118623\n174193\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n180933\n210294\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n82798\n97361\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n83090\n96472\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n97356\n108936\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n59482\n79819\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n77334\n108871\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n38777\n48531\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n111463\n128935\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n74715\n84305\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n174391\n188958\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n150558\n171869\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n122144\n148402\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n68012\n83813\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n84575\n104663\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n143045\n155742\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n51394\n73336\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n98279\n112705\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n47671\n78084\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360\n58257\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n236917\n279414\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n220631\n237883\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n185290\n219273\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n64640\n83354\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n70046\n90124\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n126971\n168462\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n144693\n165714\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n129404\n165668\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n284074\n311663\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n112268\n126892\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n203611\n229971\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n145238\n165876\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n251536\n271045\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n108078\n117731\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n238300\n256646\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n108870\n126603\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n108085\n127467\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n262835\n295688\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n248182\n336838\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n244850\n267729\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n404456\n431516\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n67608\n85667\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n33860\n51028\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\nLastly, qtm() of tmap package is used to plot the lag_sum GDPPC and w_sum_gdppc maps next to each other for quick comparison.\n\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum GDPPC\", fill.palette=\"plasma\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#importing-packages",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#importing-packages",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "2.0 Importing Packages",
    "text": "2.0 Importing Packages\n\npacman::p_load(sf, spdep, tmap, tidyverse, knitr, GWmodel)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#importing-datasets-into-environment",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#importing-datasets-into-environment",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "3.0 Importing Datasets into Environment",
    "text": "3.0 Importing Datasets into Environment\n\ngeospatial (boundary data)\n\n  #dont want to run the code again\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\marcus159260\\IS415-GAA\\in-class_exercises\\in-class_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\naspatial\n\nhunan2012_sf &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhunan2012_sf\n\n# A tibble: 88 × 29\n   County    City   avg_wage deposite    FAI Gov_Rev Gov_Exp    GDP GDPPC    GIO\n   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n 1 Anhua     Yiyang    30544   10967   6832.    457.   2703  13225  14567  9277.\n 2 Anren     Chenz…    28058    4599.  6386.    221.   1455.  4941. 12761  4189.\n 3 Anxiang   Chang…    31935    5517.  3541     244.   1780. 12482  23667  5109.\n 4 Baojing   Hunan…    30843    2250   1005.    193.   1379.  4088. 14563  3624.\n 5 Chaling   Zhuzh…    31251    8241.  6508.    620.   1947  11585  20078  9158.\n 6 Changning Hengy…    28518   10860   7920     770.   2632. 19886  24418 37392 \n 7 Changsha  Chang…    54540   24332  33624    5350    7886. 88009  88656 51361 \n 8 Chengbu   Shaoy…    28597    2581.  1922.    161.   1192.  2570. 10132  1681.\n 9 Chenxi    Huaih…    33580    4990   5818.    460.   1724.  7755. 17026  6644.\n10 Cili      Zhang…    33099    8117.  4498.    500.   2306. 11378  18714  5843.\n# ℹ 78 more rows\n# ℹ 19 more variables: Loan &lt;dbl&gt;, NIPCR &lt;dbl&gt;, Bed &lt;dbl&gt;, Emp &lt;dbl&gt;,\n#   EmpR &lt;dbl&gt;, EmpRT &lt;dbl&gt;, Pri_Stu &lt;dbl&gt;, Sec_Stu &lt;dbl&gt;, Household &lt;dbl&gt;,\n#   Household_R &lt;dbl&gt;, NOIP &lt;dbl&gt;, Pop_R &lt;dbl&gt;, RSCG &lt;dbl&gt;, Pop_T &lt;dbl&gt;,\n#   Agri &lt;dbl&gt;, Service &lt;dbl&gt;, Disp_Inc &lt;dbl&gt;, RORP &lt;dbl&gt;, ROREmp &lt;dbl&gt;"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#data-wrangling",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#data-wrangling",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "4.0 Data Wrangling",
    "text": "4.0 Data Wrangling\n\nPerform Relational Join\n\nleft_join (from dplyr package) to join by same column (County)\n\n\n\n# | eval: false\n# hunan &lt;- left_join(hunan_sf, hunan2012_sf, join_by(County)) %&gt;%   \n#   select(1:4, 7, 15)  \n\nhunan_sf &lt;- left_join(hunan, hunan2012_sf) %&gt;%\n  select(1:3, 7, 15, 16, 31, 32)\n\nJoining with `by = join_by(County)`\n\n#how do i know to pick column 15? if i were to pick 8 (last column), there will be:   #Error: Fill argument neither colors nor valid variable name(s)  #pick 6 columns (1:4, 7, 15) gives back 7 columns? (GDPPC)\n\n\nwrite_rds(hunan_sf_origin, \"data/rds/hunan_sf.rds\")\n\n\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     NAME_2  ID_3    NAME_3    County GDPPC      GIO      Agri Service\n1   Changde 21098   Anxiang   Anxiang 23667   5108.9  4524.410 14100.0\n2   Changde 21100   Hanshou   Hanshou 20981  13491.0  6545.350 17727.0\n3   Changde 21101    Jinshi    Jinshi 34592  10935.0  2562.460  7525.0\n4   Changde 21102        Li        Li 24473  18402.0  7562.340 53160.0\n5   Changde 21103     Linli     Linli 25554   8214.0  3583.910  7031.0\n6   Changde 21104    Shimen    Shimen 27137  17795.0  5266.510  6981.0\n7  Changsha 21109   Liuyang   Liuyang 63118  99254.0 10844.470 26617.8\n8  Changsha 21110 Ningxiang Ningxiang 62202 114145.0 12804.480 18447.7\n9  Changsha 21111 Wangcheng Wangcheng 70666 148976.0  5222.356  6648.6\n10 Chenzhou 21112     Anren     Anren 12761   4189.2  2357.764  3814.1\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734...\n\n\n\nconvert to SpatialPolygonDataFrame\n\nGWmodel is built around sp, not sf formats\n\n\n\nhunan_sp &lt;- hunan_sf %&gt;%\n  as_Spatial()"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#exploratory-spatial-data-analysis",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#exploratory-spatial-data-analysis",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "5.0 Exploratory Spatial Data Analysis",
    "text": "5.0 Exploratory Spatial Data Analysis\n\n5.1 determine adaptive bandwidth\n\ncross-validation (put in one, take one out)\n\n\n    bw_CV &lt;- bw.gwr(GDPPC ~ 1, \n                     data = hunan_sp,\n                     approach = \"CV\", \n                     adaptive = TRUE, \n                     kernel= \"bisquare\", \n                     longlat = T)\n\nAdaptive bandwidth: 62 CV score: 15515442343 \nAdaptive bandwidth: 46 CV score: 14937956887 \nAdaptive bandwidth: 36 CV score: 14408561608 \nAdaptive bandwidth: 29 CV score: 14198527496 \nAdaptive bandwidth: 26 CV score: 13898800611 \nAdaptive bandwidth: 22 CV score: 13662299974 \nAdaptive bandwidth: 22 CV score: 13662299974 \n\n\n\nAIC (take whole dataset, re-iterate, see how they converge)\n\n\n    bw_AIC &lt;- bw.gwr(GDPPC ~ 1, \n                     data = hunan_sp,\n                     approach = \"AIC\", \n                     adaptive = TRUE, \n                     kernel= \"bisquare\", \n                     longlat = T)\n\nAdaptive bandwidth (number of nearest neighbours): 62 AICc value: 1923.156 \nAdaptive bandwidth (number of nearest neighbours): 46 AICc value: 1920.469 \nAdaptive bandwidth (number of nearest neighbours): 36 AICc value: 1917.324 \nAdaptive bandwidth (number of nearest neighbours): 29 AICc value: 1916.661 \nAdaptive bandwidth (number of nearest neighbours): 26 AICc value: 1914.897 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \n\n\n\nbw.gwr:\n\nsince i dont have dependent variable, give GDPPC = 1, as a dependent variable\n\n\n\n\n5.2 Computing geographically weighted summary statistics\n\n#gwss object\ngwstat &lt;- gwss(data = hunan_sp,\n               vars = \"GDPPC\", \n               bw = bw_AIC,\n               kernel = \"bisquare\", \n               adaptive = TRUE,\n               longlat = T)\n\n#@data:\n# -LCV has include.self()\n\n\npreparing the output data\n\ncannot do any sorting before converting, because it will mess up the sequence\ncbind() is used to append the newly derived data.frame onto the hunan_sf sf data.frame\ngwstat_df takes out the SDF column\n\n\ngwstat_df &lt;- as.data.frame(gwstat$SDF)\n\n\nhunan_gstat &lt;- cbind(hunan_sf, gwstat_df)\n\n\n\n\n5.3 Visualising/Plotting the geographically weighted summary statistics\n\ntm_shape(hunan_gstat) + \n  tm_fill(\"GDPPC_LM\",\n          n=5,\n          style=\"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of geographically weighted mean\",\n            main.title.position = \"center\",\n            main.title.size = 2.0,\n            legend.text.size = 1.2,\n            legend.height = 1.50,\n            legend.width = 1.50,\n            frame = TRUE)"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#measuring-dispersion",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#measuring-dispersion",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "6.0 Measuring Dispersion??",
    "text": "6.0 Measuring Dispersion??"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#first-ordersecond-order-sppa",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#first-ordersecond-order-sppa",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "7.0 First Order/Second Order SPPA",
    "text": "7.0 First Order/Second Order SPPA"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#kernel-density-estimation",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#kernel-density-estimation",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "8.0 Kernel Density Estimation",
    "text": "8.0 Kernel Density Estimation"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#conclusion",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#conclusion",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "9.0 Conclusion",
    "text": "9.0 Conclusion"
  },
  {
    "objectID": "in-class_exercises/in-class_ex05/in-class_Ex05.html#references",
    "href": "in-class_exercises/in-class_ex05/in-class_Ex05.html#references",
    "title": "In-class Exercise 05: Geographically Weighted Models",
    "section": "References",
    "text": "References"
  }
]